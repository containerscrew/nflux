// Based on  https://github.com/torvalds/linux/blob/master/include/net/dropreason-core.h

pub fn reason_to_str(reason: u32) -> &'static str {
    match reason {
        2 => "NOT_SPECIFIED",
        3 => "NO_SOCKET",
        4 => "SOCKET_CLOSE",
        5 => "SOCKET_FILTER",
        6 => "SOCKET_RCVBUFF",
        7 => "UNIX_DISCONNECT",
        8 => "UNIX_SKIP_OOB",
        9 => "PKT_TOO_SMALL",
        10 => "TCP_CSUM",
        11 => "UDP_CSUM",
        12 => "NETFILTER_DROP",
        13 => "OTHERHOST",
        14 => "IP_CSUM",
        15 => "IP_INHDR",
        16 => "IP_RPFILTER",
        17 => "UNICAST_IN_L2_MULTICAST",
        18 => "XFRM_POLICY",
        19 => "IP_NOPROTO",
        20 => "PROTO_MEM",
        21 => "TCP_AUTH_HDR",
        22 => "TCP_MD5NOTFOUND",
        23 => "TCP_MD5UNEXPECTED",
        24 => "TCP_MD5FAILURE",
        25 => "TCP_AONOTFOUND",
        26 => "TCP_AOUNEXPECTED",
        27 => "TCP_AOKEYNOTFOUND",
        28 => "TCP_AOFAILURE",
        29 => "SOCKET_BACKLOG",
        30 => "TCP_FLAGS",
        31 => "TCP_ABORT_ON_DATA",
        32 => "TCP_ZEROWINDOW",
        33 => "TCP_OLD_DATA",
        34 => "TCP_OVERWINDOW",
        35 => "TCP_OFOMERGE",
        36 => "TCP_RFC7323_PAWS",
        37 => "TCP_RFC7323_PAWS_ACK",
        38 => "TCP_OLD_SEQUENCE",
        39 => "TCP_INVALID_SEQUENCE",
        40 => "TCP_INVALID_ACK_SEQUENCE",
        41 => "TCP_RESET",
        42 => "TCP_INVALID_SYN",
        43 => "TCP_CLOSE",
        44 => "TCP_FASTOPEN",
        45 => "TCP_OLD_ACK",
        46 => "TCP_TOO_OLD_ACK",
        47 => "TCP_ACK_UNSENT_DATA",
        48 => "TCP_OFO_QUEUE_PRUNE",
        49 => "TCP_OFO_DROP",
        50 => "IP_OUTNOROUTES",
        51 => "BPF_CGROUP_EGRESS",
        52 => "IPV6DISABLED",
        53 => "NEIGH_CREATEFAIL",
        54 => "NEIGH_FAILED",
        55 => "NEIGH_QUEUEFULL",
        56 => "NEIGH_DEAD",
        57 => "TC_EGRESS",
        58 => "SECURITY_HOOK",
        59 => "QDISC_DROP",
        60 => "QDISC_OVERLIMIT",
        61 => "QDISC_CONGESTED",
        62 => "CAKE_FLOOD",
        63 => "FQ_BAND_LIMIT",
        64 => "FQ_HORIZON_LIMIT",
        65 => "FQ_FLOW_LIMIT",
        66 => "CPU_BACKLOG",
        67 => "XDP",
        68 => "TC_INGRESS",
        69 => "UNHANDLED_PROTO",
        70 => "SKB_CSUM",
        71 => "SKB_GSO_SEG",
        72 => "SKB_UCOPY_FAULT",
        73 => "DEV_HDR",
        74 => "DEV_READY",
        75 => "FULL_RING",
        76 => "NOMEM",
        77 => "HDR_TRUNC",
        78 => "TAP_FILTER",
        79 => "TAP_TXFILTER",
        80 => "ICMP_CSUM",
        81 => "INVALID_PROTO",
        82 => "IP_INADDRERRORS",
        83 => "IP_INNOROUTES",
        84 => "IP_LOCAL_SOURCE",
        85 => "IP_INVALID_SOURCE",
        86 => "IP_LOCALNET",
        87 => "IP_INVALID_DEST",
        88 => "PKT_TOO_BIG",
        89 => "DUP_FRAG",
        90 => "FRAG_REASM_TIMEOUT",
        91 => "FRAG_TOO_FAR",
        92 => "TCP_MINTTL",
        93 => "IPV6_BAD_EXTHDR",
        94 => "IPV6_NDISC_FRAG",
        95 => "IPV6_NDISC_HOP_LIMIT",
        96 => "IPV6_NDISC_BAD_CODE",
        97 => "IPV6_NDISC_BAD_OPTIONS",
        98 => "IPV6_NDISC_NS_OTHERHOST",
        99 => "QUEUE_PURGE",
        100 => "TC_COOKIE_ERROR",
        101 => "PACKET_SOCK_ERROR",
        102 => "TC_CHAIN_NOTFOUND",
        103 => "TC_RECLASSIFY_LOOP",
        104 => "VXLAN_INVALID_HDR",
        105 => "VXLAN_VNI_NOT_FOUND",
        106 => "MAC_INVALID_SOURCE",
        107 => "VXLAN_ENTRY_EXISTS",
        108 => "NO_TX_TARGET",
        109 => "IP_TUNNEL_ECN",
        110 => "TUNNEL_TXINFO",
        111 => "LOCAL_MAC",
        112 => "ARP_PVLAN_DISABLE",
        113 => "MAC_IEEE_MAC_CONTROL",
        114 => "BRIDGE_INGRESS_STP_STATE",
        115 => "MAX",
        _ => "UNKNOWN_REASON",
    }
}

pub fn reason_description(reason: u32) -> &'static str {
    match reason {
        2 => "Unspecified drop reason",
        3 => "No socket available to receive the packet",
        4 => "Socket closed before packet was handled",
        5 => "Dropped by a socket-level filter",
        6 => "Receive buffer full on socket",
        7 => "UNIX socket disconnect event",
        8 => "Out-of-band data skipped (UNIX)",
        9 => "Packet too small to process",
        10 => "TCP checksum invalid",
        11 => "UDP checksum invalid",
        12 => "Dropped by netfilter (iptables/nftables)",
        13 => "Packet addressed to another host",
        14 => "IP checksum error",
        15 => "Invalid IP header",
        16 => "Reverse path filter check failed",
        17 => "Unicast packet received on L2 multicast",
        18 => "Dropped by IPsec policy",
        19 => "Unsupported IP protocol",
        20 => "Not enough memory for protocol processing",
        21 => "TCP Authentication Option header issue",
        22 => "TCP MD5 key not found",
        23 => "Unexpected TCP MD5 option",
        24 => "TCP MD5 authentication failure",
        25 => "TCP AO key not found",
        26 => "Unexpected TCP AO option",
        27 => "TCP AO key not valid",
        28 => "TCP AO authentication failure",
        29 => "Socket backlog full",
        30 => "TCP flags invalid or unexpected",
        31 => "TCP aborted due to data in SYN",
        32 => "TCP zero window condition",
        33 => "Old TCP data received",
        34 => "TCP data exceeds window",
        35 => "TCP out-of-order merge failure",
        36 => "TCP PAWS check failed (RFC7323)",
        37 => "TCP PAWS check failed on ACK",
        38 => "TCP received old sequence number",
        39 => "TCP sequence number invalid",
        40 => "TCP ACK sequence invalid",
        41 => "TCP RST received",
        42 => "TCP SYN invalid",
        43 => "TCP connection closed",
        44 => "TCP Fast Open related drop",
        45 => "Old TCP ACK received",
        46 => "TCP ACK too old",
        47 => "ACK sent for unsent data",
        48 => "Pruned TCP out-of-order queue",
        49 => "Dropped packet in out-of-order queue",
        50 => "No route to destination (IP)",
        51 => "Dropped by cgroup egress BPF",
        52 => "IPv6 disabled",
        53 => "Failed to create neighbor entry",
        54 => "Neighbor resolution failed",
        55 => "Neighbor queue full",
        56 => "Dead neighbor entry",
        57 => "Dropped by egress TC",
        58 => "Dropped by security hook",
        59 => "Queueing discipline dropped the packet",
        60 => "Qdisc over limit",
        61 => "Qdisc congestion",
        62 => "CAKE queue flooded",
        63 => "CAKE band exceeded",
        64 => "CAKE horizon limit hit",
        65 => "CAKE flow limit exceeded",
        66 => "CPU receive backlog full",
        67 => "Dropped by XDP program",
        68 => "Dropped by ingress TC",
        69 => "Unhandled protocol",
        70 => "Checksum error in skb",
        71 => "GSO segmentation failure",
        72 => "User copy fault (skb ucopy)",
        73 => "Device header issue",
        74 => "Device not ready",
        75 => "Full ring buffer",
        76 => "Out of memory",
        77 => "Truncated header",
        78 => "Filtered by TAP device",
        79 => "TX filtered by TAP",
        80 => "ICMP checksum error",
        81 => "Invalid protocol",
        82 => "Address error in IP input",
        83 => "No route for IP input",
        84 => "Local source address rejected",
        85 => "Invalid IP source address",
        86 => "Localnet restriction hit",
        87 => "Invalid IP destination",
        88 => "Packet too big for MTU",
        89 => "Duplicate fragment",
        90 => "Fragment reassembly timed out",
        91 => "Fragment too far apart",
        92 => "TCP TTL too low",
        93 => "Invalid IPv6 extension header",
        94 => "NDisc dropped fragmented packet",
        95 => "IPv6 hop limit too low",
        96 => "NDisc code field invalid",
        97 => "NDisc options invalid",
        98 => "NDisc NS for another host",
        99 => "Queue purged",
        100 => "TC cookie validation error",
        101 => "Packet socket error",
        102 => "TC chain not found",
        103 => "TC reclassification loop",
        104 => "VXLAN invalid header",
        105 => "VXLAN VNI not found",
        106 => "MAC address source invalid",
        107 => "VXLAN entry already exists",
        108 => "No target for transmission",
        109 => "IP tunnel ECN drop",
        110 => "Tunnel TX metadata error",
        111 => "Local MAC filtered",
        112 => "ARP PVLAN disabled",
        113 => "Dropped due to IEEE MAC control",
        114 => "Dropped by STP ingress state on bridge",
        115 => "Max drop reason (enum end marker)",
        _ => "Unknown or undocumented drop reason",
    }
}
